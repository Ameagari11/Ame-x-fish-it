local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()

-- local services
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local hrp = character:WaitForChild("HumanoidRootPart")

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local FishingController = require(ReplicatedStorage.Controllers.FishingController)
local GetItem = require(ReplicatedStorage.Shared.ItemUtility)
local RFSellAllItems = ReplicatedStorage.Packages._Index["sleitnick_net@0.2.0"].net["RF/SellAllItems"] 
local RunService = game:GetService("RunService")
local hoverConnection 
local RFPurchaseFishingRod = ReplicatedStorage.Packages._Index["sleitnick_net@0.2.0"].net["RF/PurchaseFishingRod"]
local RFPurchaseBait = ReplicatedStorage.Packages._Index["sleitnick_net@0.2.0"].net["RF/PurchaseBait"]
local RFPurchaseWeatherEvent = ReplicatedStorage.Packages._Index["sleitnick_net@0.2.0"].net["RF/PurchaseWeatherEvent"]
-- ===================================================================================
getgenv().LegitClickDelay = 0.01
getgenv().BlatantFishing = false
getgenv().FishingDelay = 0.1 
getgenv().AutoCompleteDelay = 0.1 


getgenv().AutoChargeSpeedEnabled = false
getgenv().ChargeSpeedDelay = 1.2 

getgenv().AutoCastMinigamesEnabled = false
getgenv().CastDelay = 0.1
getgenv().MinigameCompleteDelayCasting = 1.2

local function sellAllFish()
    RFSellAllItems:InvokeServer()
    WindUI:Notify({
        Title = "Items Sold!",
        Content = "All fish and items have been sold.",
        Duration = 2,
        Icon = "dollar-sign"
    })
end
-- ===================================================================================

WindUI:AddTheme({
    Name = "My Theme", -- theme name

    Accent = Color3.fromHex("#18181b"),
    Dialog = Color3.fromHex("#161616"),
    Outline = Color3.fromHex("#FFFFFF"),
    Text = Color3.fromHex("#FFFFFF"),
    Placeholder = Color3.fromHex("#7a7a7a"),
    Background = Color3.fromHex("#101010"),
    Button = Color3.fromHex("#52525b"),
    Icon = Color3.fromHex("#a1a1aa")
})

local Window = WindUI:CreateWindow({
    Title = "Amescript x Fish It! ðŸŸ",
    Icon = "fish", -- lucide icon
    Author = "by Ameagari11",
    Folder = "AmeHub",


    -- â†“ This all is Optional. You can remove it.
    Size = UDim2.fromOffset(580, 460),
    MinSize = Vector2.new(560, 350),
    MaxSize = Vector2.new(850, 560),
    Transparent = true,
    Theme = "Dark",
    Resizable = true,
    SideBarWidth = 200,
    BackgroundImageTransparency = 0.42,
    HideSearchBar = true,
    ScrollBarEnabled = false,


    User = {
        Enabled = true,
        Anonymous = false,
        Callback = function()
            print("clicked")
        end,
    },

})

Window:Tag({
    Title = "v1 beta",
    Color = Color3.fromHex("#30ff6a"),
    Radius = 10, -- from 0 to 13
})

Window:SetToggleKey(Enum.KeyCode.LeftControl)
Window:EditOpenButton({
    Title = "Ame x Talon",
    Icon = "expand",
    CornerRadius = UDim.new(0,16),
    StrokeThickness = 2,
    Color = ColorSequence.new( -- gradient
        Color3.fromHex("FF0F7B"),
        Color3.fromHex("F89B29")
    ),
    OnlyMobile = false,
    Enabled = true,
    Draggable = true,
})
-- Discord
local InfoTab = Window:Tab({ -- Renamed for clarity
	Title = "Info",
	Icon = "",
	Locked = false,
})


InfoTab:Button({ -- Added to InfoTab
    Title = "Amescript v1",
    Desc = "script ini masih dalam tahap pengembangan , [dibuat oleh Ame]",
    Opened = true,
})


local MainTab = Window:Tab({ 
	Title = "Main",
	Icon = "",
	Locked = false,
})

--Main = farm
local normalAutofarm = false -- 

local LegitFishingSection = MainTab:Section({ 
    Title = "Fishing",
})

-- legit
local normalAutofishingToggle = LegitFishingSection:Toggle({ 
    Title = "Legit Fishing",
    Desc = "Toggle To Start Fishing with standard fishing mechanics.",
    Icon = "fish", 
    Value = false, 
    Callback = function(Value)
        if Value then
            getgenv().BlatantFishing = false 
            getgenv().AutoChargeSpeedEnabled = false
            getgenv().AutoCastMinigamesEnabled = false 

            if blatantAutofishingToggle then blatantAutofishingToggle:SetValue(false) end 
            if autoChargeSpeedToggle then autoChargeSpeedToggle:SetValue(false) end
            if autoCastMinigamesToggle then autoCastMinigamesToggle:SetValue(false) end


            normalAutofarm = true
            WindUI:Notify({Title = "Normal Auto Fishing", Content = "Enabled.", Duration = 2, Icon = "check"})
        else
            normalAutofarm = false
            WindUI:Notify({Title = "Normal Auto Fishing", Content = "Disabled.", Duration = 2, Icon = "x"})
        end
    end
})

-- Input

LegitFishingSection:Input({
    Title = "Legit Click Delay",
    Desc = "Enter the delay between clicks (e.g., 0.01 for fast).",
    Value = tostring(getgenv().LegitClickDelay), -- Convert number to string for input field
    InputIcon = "clock",
    Type = "Input",
    Placeholder = "0.01",
    Callback = function(input)
        local newDelay = tonumber(input)
        if newDelay and newDelay > 0 then -- Basic validation: must be a positive number
            getgenv().LegitClickDelay = newDelay
            WindUI:Notify({Title = "Legit Click Delay", Content = "Set to: " .. string.format("%.3f", newDelay) .. "s", Duration = 1, Icon = "clock"})
        else
            WindUI:Notify({Title = "Invalid Input", Content = "Please enter a positive number for delay.", Duration = 2, Icon = "alert-triangle"})
        end
    end
})


-- Legit
task.spawn(function()
    while true do
        if normalAutofarm then
            FishingController:RequestChargeFishingRod(Vector2.new(0, 0), true)
            local guid = FishingController.GetCurrentGUID and FishingController:GetCurrentGUID()
            if guid then
                while guid == FishingController:GetCurrentGUID() do
                    FishingController:FishingMinigameClick()
                    task.wait(getgenv().LegitClickDelay)
                end
            end
        end
        task.wait(0.2)
    end
end)


local BlatantFishingSection = MainTab:Section({ 
    Title = "Blatant",
})

-- BLATANT FISHING TOGGLE
local blatantsection = BlatantFishingSection:Toggle({
    Title = "Blatant Fishing",
    Desc = "Activate Instant Fishing with skipping.",
    Icon = "target",
    Value = getgenv().AutoCastMinigamesEnabled,
    Callback = function(Value)
        getgenv().AutoCastMinigamesEnabled = Value
        if Value then
            WindUI:Notify({Title = "Cast & Minigames Active", Content = "Automatic cast and minigames enabled.", Duration = 3, Icon = "target"})
            print("[Auto-Cast & Minigames] ðŸŽ¯ Automatic cast and minigames ACTIVATED")
            task.spawn(function()
                local NetRoot = ReplicatedStorage:FindFirstChild("Packages") and ReplicatedStorage.Packages._Index["sleitnick_net@0.2.0"] and ReplicatedStorage.Packages._Index["sleitnick_net@0.2.0"].net
                if not NetRoot then return end
                local ChargeEvent = NetRoot["RF/ChargeFishingRod"]
                local MiniGameEvent = NetRoot["RF/RequestFishingMinigameStarted"]
                local CompleteEvent = NetRoot["RE/FishingCompleted"]

                while getgenv().AutoCastMinigamesEnabled do
                    local castDelay = getgenv().CastDelay
                    local minigameCompleteDelay = getgenv().MinigameCompleteDelayCasting
                    pcall(function() if ChargeEvent then ChargeEvent:InvokeServer(1) end end)
                    task.wait(castDelay) 

                    -- Trigger minigame (after charging delay)
                    pcall(function()
                        if MiniGameEvent then
                            MiniGameEvent:InvokeServer(math.random(-1,1), math.random(), math.random(1000000,9999999))
                        end
                    end)
                    task.wait(minigameCompleteDelay)

                    -- Complete fishing
                    pcall(function() if CompleteEvent then CompleteEvent:FireServer() end end)
                    task.wait(minigameCompleteDelay)
                end
            end)
        else
            WindUI:Notify({Title = "Cast & Minigames Inactive", Content = "Automatic cast and minigames disabled.", Duration = 3, Icon = "target"})
            print("[Auto-Cast & Minigames] ðŸŽ¯ Automatic cast and minigames DEACTIVATED")
        end
    end
})

-- Slider for adjusting Cast Delay
local blatantsection = BlatantFishingSection:Slider({
    Title = "Cast Delay",
    Desc = "Adjust the delay for casting the rod.", 
    Step = 0.01,
    Value = {
        Min = 0.001,
        Max = 5,
        Default = getgenv().CastDelay or 0.1
    },
    Callback = function(value)
        getgenv().CastDelay = value
    end
})

-- Slider for adjusting Minigame Completion Delay after cast
local blatantsection = BlatantFishingSection:Slider({
    Title = "Complete Delay",
    Desc = "set the delay to complete fishing.",
    Step = 0.01,
    Value = {
        Min = 0.001,
        Max = 5,
        Default = getgenv().MinigameCompleteDelayCasting or 1.00
    },
    Callback = function(value)
        getgenv().MinigameCompleteDelayCasting = value
    end
})


-- auto sell
local AutoSellSection = MainTab:Section({ 
	Title = "Auto Sell"
})

local sellDelay = 5 
local autoSell = false 

AutoSellSection:Slider({ 
    Title = "Auto Sell Delay",
    Desc = "set autosell delay 30-100",
    Step = 1,
    Value = {
        Min = 1,
        Max = 60,
        Default = sellDelay, 
    },
    Callback = function(value)
        sellDelay = value 
        print("[Auto Sell] Delay changed to:", sellDelay)
    end
})

AutoSellSection:Toggle({ 
    Title = "Toggle Auto Sell",
    Desc = "Automatically sells all items at regular intervals.",
    Icon = "dollar-sign", 
    Value = false, 
    Callback = function(Value)
        autoSell = Value
        if Value then
            WindUI:Notify({Title = "Auto Sell Enabled", Content = "Automatic selling is active.", Duration = 2, Icon = "check"})
            print("[Auto Sell] Enabled")
        else
            WindUI:Notify({Title = "Auto Sell Disabled", Content = "Automatic selling is off.", Duration = 2, Icon = "x"})
            print("[Auto Sell] Disabled")
        end
    end
})

AutoSellSection:Button({ -- Added to AutoSellSection
    Title = "Sell All Items Now",
    Desc = "Manually sell all items in your inventory.",
    Locked = false,
    Callback = function()
        sellAllFish() 
    end
})

task.spawn(function()
    while true do
        if autoSell then
            RFSellAllItems:InvokeServer()
            task.wait(sellDelay)
        end
        task.wait(0.1)
    end
end)

-- Event
local EventSection = MainTab:Section({
	Title = "Event"
})

local Paragraph = EventSection:Paragraph({ 
    Title = "Under Development",
    Color = "Red",
    Image = "",
    ImageSize = 30,
    Thumbnail = "",
    ThumbnailSize = 80,
    Locked = false,
})

-- Shop
local ShopTab = Window:Tab({ 
	Title = "Shop",
	Icon = "",
	Locked = false,
})

local BuyRodSection = ShopTab:Section({
    Title = "Buy Rod",
})

local rods = {
    ["Luck Rod"] = 79,
    ["Carbon Rod"] = 76,
    ["Grass Rod"] = 85,
    ["Demascus Rod"] = 77,
    ["Ice Rod"] = 78,
    ["Lucky Rod"] = 4,
    ["Midnight Rod"] = 80,
    ["Steampunk Rod"] = 6,
    ["Chrome Rod"] = 7,
    ["Flourescent Rod"] = 255,
    ["Astral Rod"] = 5
}
local rodNamesList = {}
for name, _ in pairs(rods) do
    table.insert(rodNamesList, name)
end

local selectedRod = rodNamesList[1]

BuyRodSection:Dropdown({ -- Added to BuyRodSection
    Title = "Select Fishing Rod",
    Values = rodNamesList,
    Multi = false,
    AllowNone = true,
    Callback = function(Value)
        selectedRod = Value
    end
})

BuyRodSection:Button({ -- Added to BuyRodSection
    Title = "Purchase Rod",
    Locked = false,
    Callback = function()
        local rodId = rods[selectedRod]
		if rodId then
			RFPurchaseFishingRod:InvokeServer(rodId)
            WindUI:Notify({Title = "Rod Purchased", Content = "You bought a " .. selectedRod .. "!", Duration = 3, Icon = "shopping-cart"})
		end
    end
})

local BuyBaitSection = ShopTab:Section({
    Title = "Buy Bait",
})

local bait = {
    ["TopWater Bait"] = 10,
    ["Luck Bait"] = 2,
    ["Midnight Bait"] = 3,
    ["Nature Bait"] = 17,
    ["Chroma Bait"] = 6,
    ["Dark Matter Bait"] = 8,
    ["Corrupt Bait"] = 15,
    ["Aether Bait"] = 16,
    ["Floral Bait"] = 20
}

local baitNamesList = {}
for name, _ in pairs(bait) do
    table.insert(baitNamesList, name)
end

local selectedBait = baitNamesList[1]

BuyBaitSection:Dropdown({ 
    Title = "Select Bait",
    Values = baitNamesList,
    Multi = false,
    AllowNone = true,
    Callback = function(Value)
        selectedBait = Value
    end
})

BuyBaitSection:Button({ 
    Title = "Purchase Bait",
    Callback = function()
        local baitId = bait[selectedBait]
        if baitId then
            RFPurchaseBait:InvokeServer(baitId)
            WindUI:Notify({Title = "Bait Purchased", Content = "You bought " .. selectedBait .. "!", Duration = 3, Icon = "shopping-cart"})
        end
    end
})

local buyWeatherSection = ShopTab:Section({
	Title = "Buy Weather",
})

local weather = {
    "Wind",
    "Cloudy",
    "Snow",
    "Storm",
    "Radiant",
    "Shark Hunt",
}

local weatherlist = {}
for _, name in ipairs(weather) do
    table.insert(weatherlist, name)
end

local selectedweather = weatherlist[1]

buyWeatherSection:Dropdown({
    Title = "Select Weather",
    Values = weatherlist, 
    Multi = false,
    AllowNone = true,
    Callback = function(Value)
        selectedweather = Value
    end
})

buyWeatherSection:Button({
    Title = "Purchase Weather",
    Callback = function()
        if selectedweather then
            RFPurchaseWeatherEvent:InvokeServer(unpack({selectedweather}))

            print("[Weather Purchase] Attempted to purchase:", selectedweather)
        else
            print("[Weather Purchase] No weather selected.")
        end
    end
})


--Teleport
local TeleportTab = Window:Tab({ 
    Title = "Teleport",
    Icon = "", -- optional
    Locked = false,
})

local IslandLocationsSection = TeleportTab:Section({ Title = "Island Teleports" }) -- New section for islands

local Island_name = {
    ["Ancient Jungle"] = {1464, 8, -321},
    ["Sacred temple"] = {1477, -22, -629},
    ["Temple Guardian"] = {1483, 128, -587},
    ["Coral Reef"] = {-2855, 47, 1988},
    ["Crater Island"] = {1114, 21, 5043},
    ["Esoteric Depths"] = {3257, -1301, 1390},
    ["Esoteric Island"] = {2035, 27, 1389},
    ["Kohana volcano"] = {-559.92,21.39,151.07},
    ["Kohana"] = {-623.96,19.25,419.36},
    ["Treasure room"] = {-3602.01, -266.57, -1577.18},
    ["Underground cellar"] = {2136.00,-91.20,-699.00},
    ["Sysyphus statue"] = {-3703.69,-135.57,-1017.17},
    ["Treasure room"] = {-3602.01,-266.57,-1577.18},
    ["Weather Machine"] = {-1523.55,2.87,1913.72},
    ["Crystals admin event"] = {-1918.24,-447.50,7391.70},
}

local isleList = {}
for name, _ in pairs(Island_name) do
    table.insert(isleList, name)
end

local selected_isle = isleList[1]

IslandLocationsSection:Dropdown({ -- Added to IslandLocationsSection
    Title = "Select Island TP",
    Values = isleList,
    Multi = false,
    AllowNone = true,
    Callback = function(Value)
        selected_isle = Value
    end
})


IslandLocationsSection:Button({
    Title = "Click To Teleport",
    Locked = false,
    Callback = function()
        local islandID = Island_name[selected_isle]
        if islandID then
            game.Players.LocalPlayer.Character:MoveTo(Vector3.new(unpack(islandID)))
            WindUI:Notify({Title = "Teleported", Content = "Teleported to " .. selected_isle .. ".", Duration = 3, Icon = "map-pin"})
        else
            WindUI:Notify({Title = "Teleport Failed", Content = "Please select an island.", Duration = 3, Icon = "alert-triangle"})
        end
    end
})

local FarmThresholdSection = TeleportTab:Section({
    Title = "Farm Threshold",
    Icon = "",
    Opened = true,
})

local Threshold = {
    ["Stone"] = {-2013, 6, 3759},
    ["Coins"] = {1066, 57, 5046},
}

local thresholdLocation = {}
for name, _ in pairs(Threshold) do
    table.insert(thresholdLocation, name)
end

local selectedThreshold = thresholdLocation[1]

FarmThresholdSection:Dropdown({ -- Added to FarmThresholdSection
    Title = "Select where you wanna farm",
    Values = thresholdLocation,
    Multi = false,
    AllowNone = true,
    Callback = function(Value)
        selectedThreshold = Value
    end
})

local autoFarmThreshold = false

FarmThresholdSection:Toggle({ -- Added to FarmThresholdSection
    Title = "Teleport to Farm Threshold",
    Icon = "map-pin", -- Added icon
    Value = false,
    Callback = function(state)
        if state then
            local coords = Threshold[selectedThreshold]
            if coords then
                game.Players.LocalPlayer.Character:MoveTo(Vector3.new(unpack(coords)))

				WindUI:Notify({
    			Title = "Teleporting",
    			Content = "Enable Fishing to start farming",
    			Duration = 3, -- 3 seconds
    			Icon = "flower",
				})
            else
                WindUI:Notify({Title = "Teleport Failed", Content = "Please select a farm threshold.", Duration = 3, Icon = "alert-triangle"})
                FarmThresholdSection:Toggle():SetValue(false) -- Turn off toggle if no coords
            end
        end
    end
})

local TempleLeaverSection = TeleportTab:Section({
    Title = "Temple Leaver",
    Icon = "",
    Opened = true,
})

TempleLeaverSection:Button({ -- Added to TempleLeaverSection
    Title = "Diamond Artifacts",
    Locked = false,
    Callback = function()
        local character = game.Players.LocalPlayer.Character or game.Players.LocalPlayer.CharacterAdded:Wait()
        character:WaitForChild("HumanoidRootPart").CFrame = CFrame.new(1826, 8, -285)
        WindUI:Notify({Title = "Teleported", Content = "To Diamond Artifacts.", Duration = 2, Icon = "map-pin"})
    end
})

TempleLeaverSection:Button({ -- Added to TempleLeaverSection
    Title = "Arrow Artifacts",
    Locked = false,
    Callback = function()
        local character = game.Players.LocalPlayer.Character or game.Players.LocalPlayer.CharacterAdded:Wait()
        character:WaitForChild("HumanoidRootPart").CFrame = CFrame.new(893, 8, -364)
        WindUI:Notify({Title = "Teleported", Content = "To Arrow Artifacts.", Duration = 2, Icon = "map-pin"})
    end
})

TempleLeaverSection:Button({ -- Added to TempleLeaverSection
    Title = "Hourglass Diamond Artifacts",
    Locked = false,
    Callback = function()
        local character = game.Players.LocalPlayer.Character or game.Players.LocalPlayer.CharacterAdded:Wait()
        character:WaitForChild("HumanoidRootPart").CFrame = CFrame.new(1487, 7, -851)
        WindUI:Notify({Title = "Teleported", Content = "To Hourglass Diamond Artifacts.", Duration = 2, Icon = "map-pin"})
    end
})

TempleLeaverSection:Button({ -- Added to TempleLeaverSection
    Title = "Crescent Artifacts",
    Locked = false,
    Callback = function()
        local character = game.Players.LocalPlayer.Character or game.Players.LocalPlayer.CharacterAdded:Wait()
        character:WaitForChild("HumanoidRootPart").CFrame = CFrame.new(1414, 30, 84)
        WindUI:Notify({Title = "Teleported", Content = "To Crescent Artifacts.", Duration = 2, Icon = "map-pin"})
    end
})


--================================================--
--   MISC TAB SETTINGS / GRAPHIC MODE TOGGLES     --
--================================================--

local Lighting = game:GetService("Lighting")
local terrain = workspace:FindFirstChildOfClass("Terrain")

local TabMisc = Window:Tab({
    Title = "Misc",
    Icon = "activity",
    Locked = false
})

--================== Save Original State ==================--
local originalLighting = {
    Brightness = Lighting.Brightness,
    GlobalShadows = Lighting.GlobalShadows,
    OutdoorAmbient = Lighting.OutdoorAmbient,
    FogEnd = Lighting.FogEnd
}

local originalEffects = {}
for _, effect in pairs(Lighting:GetChildren()) do
    if effect:IsA("PostEffect") then
        originalEffects[effect] = effect.Enabled
    end
end

local originalTerrain = {}
if terrain then
    originalTerrain = {
        WaterReflectance = terrain.WaterReflectance,
        WaterTransparency = terrain.WaterTransparency,
        WaterColor = terrain.WaterColor
    }
end

local originalSky = workspace:FindFirstChildOfClass("Sky")
if originalSky then
    originalSky = originalSky:Clone() -- clone before destroy
end

local changedObjects = {}

--================== Ultra-Low Graphics ==================--
local function applyUltraLow()
    changedObjects = {}
    for _, part in pairs(workspace:GetDescendants()) do
        if part:IsA("BasePart") then
            changedObjects[part] = {
                Color = part.Color,
                Material = part.Material,
                Reflectance = part.Reflectance,
                Transparency = part.Transparency,
                CastShadow = part.CastShadow
            }
            part.Color = Color3.new(1,1,1)
            part.Material = Enum.Material.Plastic
            part.Reflectance = 0
            part.Transparency = 0
            part.CastShadow = false

        elseif part:IsA("ParticleEmitter") or part:IsA("Trail") or part:IsA("Beam") then
            changedObjects[part] = {Enabled = part.Enabled}
            part.Enabled = false

        elseif part:IsA("Decal") or part:IsA("Texture") then
            changedObjects[part] = {Transparency = part.Transparency}
            part.Transparency = 1

        elseif part:IsA("Sky") then
            changedObjects[part] = {Parent = part.Parent}
            part:Destroy()
        end
    end

    Lighting.Brightness = 1
    Lighting.GlobalShadows = false
    Lighting.OutdoorAmbient = Color3.new(1,1,1)
    Lighting.FogEnd = 100000

    for effect in pairs(originalEffects) do
        if effect and effect.Parent then
            effect.Enabled = false
        end
    end

    if terrain then
        terrain.WaterReflectance = 0
        terrain.WaterTransparency = 1
        terrain.WaterColor = Color3.new(1,1,1)
    end
end

local function resetUltraLow()
    for obj, props in pairs(changedObjects) do
        if obj and obj.Parent then
            for prop, value in pairs(props) do
                if obj[prop] ~= nil then
                    obj[prop] = value
                end
            end
        end
    end
    changedObjects = {}

    for prop, value in pairs(originalLighting) do
        Lighting[prop] = value
    end
    for effect, state in pairs(originalEffects) do
        if effect and effect.Parent then
            effect.Enabled = state
        end
    end
    if terrain then
        for prop, value in pairs(originalTerrain) do
            terrain[prop] = value
        end
    end
    if originalSky and not workspace:FindFirstChildOfClass("Sky") then
        originalSky:Clone().Parent = workspace
    end
end

--================== Buttons ==================--
TabMisc:Button({
    Title = "Ultra-Low Mode",
    Desc = "Toggle extreme low graphics mode (click again to disable)",
    Locked = false,
    Callback = function()
        getgenv().UltraLowOn = not getgenv().UltraLowOn
        if getgenv().UltraLowOn then
            applyUltraLow()
        else
            resetUltraLow()
        end
    end
})


TabMisc:Button({
    Title = "Medium Graphics",
    Desc = "Toggle medium-level graphics (reduced effects, smoother performance)",
    Locked = false,
    Callback = function()
        getgenv().MediumOn = not getgenv().MediumOn

        if getgenv().MediumOn then
            Lighting.Ambient = Color3.fromRGB(128, 128, 128)
            Lighting.Brightness = 2
            Lighting.GlobalShadows = true
            Lighting.FogEnd = 100000
            for _, obj in pairs(workspace:GetDescendants()) do
                if obj:IsA("ParticleEmitter") or obj:IsA("Beam") or obj:IsA("Trail") then
                    obj.Enabled = true
                elseif obj:IsA("MeshPart") then
                    obj.Material = Enum.Material.Plastic
                end
            end
            if terrain then
                terrain.WaterWaveSize = 1
                terrain.WaterWaveSpeed = 1
                terrain.WaterReflectance = 0.5
                terrain.WaterTransparency = 0.5
            end
        else
            Lighting.Ambient = Color3.new(1, 1, 1)
            Lighting.Brightness = 1
            Lighting.GlobalShadows = false
            Lighting.FogEnd = 100000
            for _, obj in pairs(workspace:GetDescendants()) do
                if obj:IsA("ParticleEmitter") or obj:IsA("Beam") or obj:IsA("Trail") then
                    obj.Enabled = false
                elseif obj:IsA("MeshPart") then
                    obj.Material = Enum.Material.SmoothPlastic
                end
            end
            if terrain then
                terrain.WaterWaveSize = 0
                terrain.WaterWaveSpeed = 0
                terrain.WaterReflectance = 0
                terrain.WaterTransparency = 1
            end
        end
    end
})


-- ==============================
-- Freecam (PC & Mobile) - Misc
-- ==============================
local cam = workspace.CurrentCamera
local player = game.Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local playerGui = player:WaitForChild("PlayerGui")

local freecamEnabled = false
local yaw, pitch = 0,0
local mouseSensitivity = 0.002
local moveSpeed = 20
local keysDown = {W=false, A=false, S=false, D=false, Q=false, E=false}

local savedCamData
local camPos
local renderConn

-- Helper functions
local function saveCamera()
    return {CameraType = cam.CameraType, CameraSubject = cam.CameraSubject, CFrame = cam.CFrame}
end

local function restoreCamera(data)
    cam.CameraType = data.CameraType or Enum.CameraType.Custom
    cam.CameraSubject = data.CameraSubject or player.Character
    if data.CFrame then cam.CFrame = data.CFrame end
end

local function freezeHumanoid()
    local char = player.Character
    if char then
        local h = char:FindFirstChildOfClass("Humanoid")
        if h then
            h.WalkSpeed = 0
            h.JumpPower = 0
        end
    end
end

local function unfreezeHumanoid()
    local char = player.Character
    if char then
        local h = char:FindFirstChildOfClass("Humanoid")
        if h then
            h.WalkSpeed = 16
            h.JumpPower = 50
        end
    end
end

local function seedOrientation(cf)
    local pos = cf.Position
    local look = cf.LookVector
    yaw = math.atan2(-look.X, -look.Z)
    pitch = math.clamp(math.asin(look.Y), math.rad(-85), math.rad(85))
    return pos
end

local function keyboardMoveVector()
    local x = (keysDown.D and 1 or 0) - (keysDown.A and 1 or 0)
    local z = (keysDown.S and 1 or 0) - (keysDown.W and 1 or 0)
    local y = (keysDown.E and 1 or 0) - (keysDown.Q and 1 or 0)
    local v = Vector3.new(x,y,z)
    if v.Magnitude>1 then v = v.Unit end
    return v
end

-- =========================
-- Freecam Start/Stop
-- =========================
local function startFreecam()
    savedCamData = saveCamera()
    freezeHumanoid()
    cam.CameraType = Enum.CameraType.Scriptable
    camPos = seedOrientation(cam.CFrame)

    if not UserInputService.TouchEnabled then
        UserInputService.MouseBehavior = Enum.MouseBehavior.LockCurrentPosition
    else
        -- Mobile arrow buttons
        local gui = Instance.new("ScreenGui")
        gui.Name = "FreecamMobileControls"
        gui.ResetOnSpawn = false
        gui.Parent = playerGui

        local function createArrowButton(name, pos, rotation)
            local btn = Instance.new("TextButton")
            btn.Name = name
            btn.Size = UDim2.fromOffset(50,50)
            btn.Position = pos
            btn.BackgroundTransparency = 0.7
            btn.BackgroundColor3 = Color3.fromRGB(50,50,50)
            btn.Text = "â–²"
            btn.TextColor3 = Color3.new(1,1,1)
            btn.TextScaled = true
            btn.Rotation = rotation or 0
            btn.AutoButtonColor = false
            btn.ZIndex = 10
            btn.Parent = gui
            return btn
        end

        -- Arrow buttons layout
        local vp = cam.ViewportSize
        local buttonW = createArrowButton("W", UDim2.new(0.85,0,0.7,0),0)
        local buttonA = createArrowButton("A", UDim2.new(0.8,0,0.75,0),-90)
        local buttonS = createArrowButton("S", UDim2.new(0.85,0,0.75,0),180)
        local buttonD = createArrowButton("D", UDim2.new(0.9,0,0.75,0),90)
        local buttonQ = createArrowButton("Q", UDim2.new(0.8,0,0.8,0),-45)
        local buttonE = createArrowButton("E", UDim2.new(0.9,0,0.8,0),45)

        local buttons = {W=buttonW, A=buttonA, S=buttonS, D=buttonD, Q=buttonQ, E=buttonE}

        for key, btn in pairs(buttons) do
            btn.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.Touch then
                    keysDown[key] = true
                end
            end)
            btn.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.Touch then
                    keysDown[key] = false
                end
            end)
        end
    end

    freecamEnabled = true

    renderConn = RunService.RenderStepped:Connect(function(dt)
        local rot = CFrame.Angles(pitch, yaw, 0)
        local mv = keyboardMoveVector()
        local delta = (rot.RightVector*mv.X + Vector3.yAxis*mv.Y + rot.LookVector*mv.Z)*moveSpeed*dt
        camPos += delta
        cam.CFrame = CFrame.new(camPos)*rot
    end)
end

local function stopFreecam()
    freecamEnabled = false
    if renderConn then renderConn:Disconnect() renderConn=nil end
    restoreCamera(savedCamData)
    if not UserInputService.TouchEnabled then
        UserInputService.MouseBehavior = Enum.MouseBehavior.Default
    end
    unfreezeHumanoid()
    keysDown = {W=false,A=false,S=false,D=false,Q=false,E=false}
    -- remove mobile GUI
    local oldGui = playerGui:FindFirstChild("FreecamMobileControls")
    if oldGui then oldGui:Destroy() end
end

-- =========================
-- Rotation input
-- =========================
UserInputService.InputChanged:Connect(function(input,gp)
    if not freecamEnabled then return end
    if input.UserInputType==Enum.UserInputType.MouseMovement and not UserInputService.TouchEnabled then
        yaw -= input.Delta.X*mouseSensitivity
        pitch -= input.Delta.Y*mouseSensitivity
        pitch = math.clamp(pitch,math.rad(-85),math.rad(85))
    elseif UserInputService.TouchEnabled and input.UserInputType==Enum.UserInputType.Touch then
        local vp = cam.ViewportSize
        -- swipe di kanan layar untuk rotate
        if input.Position.X >= vp.X*0.66 then
            yaw -= input.Delta.X*mouseSensitivity
            pitch -= input.Delta.Y*mouseSensitivity
            pitch = math.clamp(pitch,math.rad(-85),math.rad(85))
        end
    end
end)

-- Keyboard (PC)
UserInputService.InputBegan:Connect(function(input,gp)
    if gp or not freecamEnabled then return end
    if input.UserInputType==Enum.UserInputType.Keyboard then
        local kc = input.KeyCode
        if kc==Enum.KeyCode.W then keysDown.W=true end
        if kc==Enum.KeyCode.A then keysDown.A=true end
        if kc==Enum.KeyCode.S then keysDown.S=true end
        if kc==Enum.KeyCode.D then keysDown.D=true end
        if kc==Enum.KeyCode.Q then keysDown.Q=true end
        if kc==Enum.KeyCode.E then keysDown.E=true end
    end
end)

UserInputService.InputEnded:Connect(function(input,gp)
    if gp or not freecamEnabled then return end
    if input.UserInputType==Enum.UserInputType.Keyboard then
        local kc = input.KeyCode
        if kc==Enum.KeyCode.W then keysDown.W=false end
        if kc==Enum.KeyCode.A then keysDown.A=false end
        if kc==Enum.KeyCode.S then keysDown.S=false end
        if kc==Enum.KeyCode.D then keysDown.D=false end
        if kc==Enum.KeyCode.Q then keysDown.Q=false end
        if kc==Enum.KeyCode.E then keysDown.E=false end
    end
end)

-- =========================
-- WindUI Misc
-- =========================
TabMisc:Toggle({
    Title = "Freecam",
    Desc = "Toggle Freecam (PC & Mobile)",
    Value = false,
    Icon = "arrow-up", -- Gunakan ikon arrow
    Callback = function(val)
        if val then startFreecam() else stopFreecam() end
    end
})

TabMisc:Input({
    Title = "Freecam Speed",
    Desc = "Set Freecam movement speed",
    Value = tostring(moveSpeed),
    Type = "Input",
    Callback = function(val)
        local n = tonumber(val)
        if n and n>0 then moveSpeed = n end
    end
})


local Section = Window:Section({
    Title = "Script ini masih dalam tahap pengembangan â›ˆ",
    Icon = "badge-info",
    Opened = true,
})
